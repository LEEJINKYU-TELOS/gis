# GIS 기본 개념 가이드

**작성자**: 이진규
**대상**: Next.js 개발자 (GIS 초보자)
**소요 시간**: 약 30분

---

## 목차

1. [GIS란 무엇인가?](#1-gis란-무엇인가)
2. [웹 지도의 작동 원리](#2-웹-지도의-작동-원리)
3. [타일맵 이해하기](#3-타일맵-이해하기)
4. [좌표계와 투영법](#4-좌표계와-투영법)
5. [줌 레벨 시스템](#5-줌-레벨-시스템)
6. [실습: 타일 URL 이해하기](#6-실습-타일-url-이해하기)

---

## 1. GIS란 무엇인가?

### 1.1 GIS의 정의

**GIS (Geographic Information System, 지리정보시스템)**는 지리적 위치와 관련된 데이터를 수집, 저장, 분석, 표시하는 시스템입니다.

쉽게 말하면:
- 구글 맵, 네이버 지도, 카카오맵 같은 지도 서비스
- 지도 위에 특정 정보를 표시하는 시스템
- 위치 기반 데이터를 다루는 모든 것

### 1.2 웹 개발자 관점에서 GIS

웹 개발자가 GIS 프로젝트에서 하는 일:

```
일반 웹 개발              vs      GIS 웹 개발
─────────────────────────────────────────────────
데이터를 테이블에 표시     →      지도 위에 데이터 표시
리스트/카드로 정보 나열    →      마커/폴리곤으로 정보 표시
페이지네이션              →      줌/팬으로 탐색
필터링/검색               →      공간 검색 (반경 N미터 내)
```

### 1.3 이 프로젝트에서 우리가 하는 일

1. **지도 표시**: 타일 이미지들을 이어붙여 큰 지도 만들기
2. **인터랙션**: 사용자가 지도를 움직이고 확대/축소
3. **데이터 표시**: 지도 위에 마커나 도형 그리기
4. **정보 제공**: 사용자가 지도를 클릭하면 상세 정보 표시

---

## 2. 웹 지도의 작동 원리

### 2.1 왜 전체 지도를 한 번에 로드하지 않을까?

**문제상황**:
- 전 세계 지도를 하나의 큰 이미지로 만들면?
- 최대 줌 레벨 (거리 이름까지 보이는 수준)에서는 수십억 픽셀!
- 파일 크기: 수십 GB ~ TB

**해결책: 타일맵 시스템**

지도를 작은 타일(256x256 픽셀)로 쪼개서:
- 사용자가 보는 화면에 필요한 타일만 로드
- 줌 레벨마다 다른 해상도의 타일 준비
- 인터넷 트래픽 절약, 빠른 로딩 속도

### 2.2 비유: 넷플릭스 스트리밍

```
넷플릭스                        타일맵
───────────────────────────────────────────
영화 전체를 다운로드 안 함  →  전체 지도를 로드 안 함
현재 재생 구간만 버퍼링    →  현재 화면에 보이는 타일만 로드
화질을 인터넷 속도에 맞춤  →  줌 레벨에 따라 해상도 변경
```

---

## 3. 타일맵 이해하기

### 3.1 타일맵이란?

타일맵은 큰 지도를 **256x256 픽셀의 정사각형 타일로 나눈 것**입니다.

```
전체 지도
┌─────────────────────────┐
│                         │
│    거대한 이미지!       │
│    (수십 GB)            │
│                         │
└─────────────────────────┘

       ↓ 타일로 쪼개기

┌───┬───┬───┬───┬───┬───┐
│ 0 │ 1 │ 2 │ 3 │ 4 │ 5 │
├───┼───┼───┼───┼───┼───┤
│ 6 │ 7 │ 8 │ 9 │10 │11 │  각 타일:
├───┼───┼───┼───┼───┼───┤  - 256x256px
│12 │13 │14 │15 │16 │17 │  - PNG/JPG
├───┼───┼───┼───┼───┼───┤  - 수십 KB
│18 │19 │20 │21 │22 │23 │
└───┴───┴───┴───┴───┴───┘
```

### 3.2 XYZ 타일 시스템

**XYZ 타일**은 웹 지도에서 가장 많이 사용되는 타일 형식입니다.

**좌표 체계**:
```
    X (가로) →
  ┌───┬───┬───┬───┐
Y │0,0│1,0│2,0│3,0│
↓ ├───┼───┼───┼───┤
(│0,1│1,1│2,1│3,1│
세├───┼───┼───┼───┤
로│0,2│1,2│2,2│3,2│
) ├───┼───┼───┼───┤
  │0,3│1,3│2,3│3,3│
  └───┴───┴───┴───┘
```

**타일 URL 형식**:
```
http://서버주소/줌레벨/X좌표/Y좌표.png

예:
http://192.168.0.140:8082/tiles/SD/L7/100/50.png
                                ↑  ↑   ↑
                              줌  X   Y
```

### 3.3 실제 동작 과정

1. **사용자가 지도 보기**
   ```
   화면 크기: 1920 x 1080 픽셀
   타일 크기: 256 x 256 픽셀
   필요한 타일: 약 8 x 5 = 40개
   ```

2. **타일 로드**
   ```javascript
   // 브라우저가 자동으로 요청
   GET /tiles/7/100/50.png
   GET /tiles/7/101/50.png
   GET /tiles/7/102/50.png
   ...
   ```

3. **지도 이동 시**
   ```
   사용자가 지도를 오른쪽으로 드래그
   → 새로운 타일 요청 (X 좌표가 증가)
   → 화면 밖으로 나간 타일은 메모리에서 제거
   ```

---

## 4. 좌표계와 투영법

### 4.1 위도와 경도

**위도 (Latitude)**:
- 적도를 기준으로 북/남 (N/S)
- 범위: -90° ~ +90°
- 서울: 약 37.5°N

**경도 (Longitude)**:
- 본초 자오선(그리니치)을 기준으로 동/서 (E/W)
- 범위: -180° ~ +180°
- 서울: 약 127°E

```
좌표 표기:
[경도, 위도]  ← 주의! 일반적으로 경도가 먼저
[127.5, 37.5] = 서울 근처
```

### 4.2 투영법 (Projection)

**문제**: 둥근 지구를 평평한 화면에 표시하기

```
🌍 (구체)  →  📱 (평면)
```

**Web Mercator (EPSG:3857)**:
- 웹 지도에서 가장 많이 사용
- 구글 맵, 네이버 지도, 카카오맵 모두 사용
- 특징:
  - 적도 근처가 정확
  - 극지방은 왜곡됨 (그린란드가 실제보다 크게 보임)

**WGS84 (EPSG:4326)**:
- GPS에서 사용하는 좌표계
- 위도/경도를 그대로 사용
- 투영하지 않은 원본 좌표

### 4.3 좌표 변환

OpenLayers는 자동으로 좌표를 변환해줍니다:

```typescript
import { fromLonLat, toLonLat } from 'ol/proj';

// WGS84 → Web Mercator
const mapCoord = fromLonLat([127.5, 37.5]);
// → [14193833.15, 4518386.79]

// Web Mercator → WGS84
const gpsCoord = toLonLat(mapCoord);
// → [127.5, 37.5]
```

---

## 5. 줌 레벨 시스템

### 5.1 줌 레벨이란?

줌 레벨은 지도의 확대 정도를 나타내는 숫자입니다.

```
Zoom 0:  전 세계가 256x256 픽셀 1개 타일
Zoom 1:  2x2 = 4개 타일
Zoom 2:  4x4 = 16개 타일
Zoom 3:  8x8 = 64개 타일
...
Zoom n:  2^n x 2^n 타일
```

### 5.2 줌 레벨별 축척

| 줌 레벨 | 축척 (적도 기준) | 용도 | 예시 |
|--------|----------------|------|------|
| 0 | 1:500,000,000 | 전 세계 | 대륙 전체 |
| 5 | 1:18,000,000 | 나라 | 한국 전체 |
| 10 | 1:500,000 | 지역 | 서울 전체 |
| 15 | 1:17,000 | 동네 | 강남구 |
| 19 | 1:1,000 | 건물 | 빌딩 하나하나 |

### 5.3 프로젝트 설정

우리 프로젝트의 줌 레벨 설정:

```typescript
// src/lib/map/mapConfig.ts
export const MAP_CONFIG = {
  initialView: {
    zoom: 7, // 초기 줌 레벨 (한국 전체가 보이는 수준)
  },
  minZoom: 6,  // 최소 줌 (더 축소 불가)
  maxZoom: 19, // 최대 줌 (더 확대 불가)
};
```

**왜 제한할까?**
- 타일이 없으면 404 에러
- 너무 확대하면 픽셀이 깨짐
- 서버에 준비된 줌 레벨 범위만 허용

---

## 6. 실습: 타일 URL 이해하기

### 6.1 타일 URL 분석

우리 프로젝트의 타일 URL:

```
http://192.168.0.140:8082/tiles/SD/L{z}/{x}/{y}.png
                                   └┬┘ └─────┬─────┘
                                    │        └─ 타일 좌표
                                    └─ 줌 레벨
```

### 6.2 실제 타일 요청 예제

**서울 시청 (경도: 126.978, 위도: 37.566)을 줌 레벨 10으로 보기**

1. **좌표 변환**:
   ```
   GPS 좌표 → 타일 좌표
   (126.978, 37.566) → (879, 393) at zoom 10
   ```

2. **타일 URL**:
   ```
   http://192.168.0.140:8082/tiles/SD/L10/879/393.png
   ```

3. **주변 타일**:
   ```
   L10/878/392.png  L10/879/392.png  L10/880/392.png
   L10/878/393.png  L10/879/393.png  L10/880/393.png  ← 서울 시청
   L10/878/394.png  L10/879/394.png  L10/880/394.png
   ```

### 6.3 브라우저에서 확인하기

1. 개발자 도구 (F12) 열기
2. Network 탭 선택
3. 지도를 움직여보기
4. PNG 파일 요청 확인

```
Request URL: http://192.168.0.140:8082/tiles/SD/L7/100/50.png
Status: 200 (또는 404 if not found)
```

---

## 7. 정리 및 다음 단계

### 7.1 핵심 개념 정리

✅ **GIS는** 지리 정보를 다루는 시스템
✅ **타일맵은** 큰 지도를 256x256 픽셀 조각으로 나눈 것
✅ **XYZ 타일은** {z}/{x}/{y} 형식의 타일 주소 체계
✅ **좌표계는** 구 형태의 지구를 평면으로 변환하는 방법
✅ **줌 레벨은** 0(세계)부터 19(건물)까지의 확대 단계

### 7.2 웹 개발자 관점 요약

```javascript
// 일반 이미지
<img src="/map.png" />  // 전체 로드, 수십 GB

// GIS 타일맵
<div id="map"></div>
// 필요한 타일만 동적 로드, 수십 KB씩
// GET /tiles/7/100/50.png
// GET /tiles/7/101/50.png
// ...
```

### 7.3 다음 학습 단계

1. **[OpenLayers 가이드](./OPENLAYERS_GUIDE.md)**:
   - Map, View, Layer 구조
   - 실제 코드에서 어떻게 사용하는지

2. **[컴포넌트 가이드](./COMPONENT_GUIDE.md)**:
   - 우리 프로젝트의 컴포넌트 구조
   - 각 파일의 역할

---

## 8. 추가 학습 자료

### 8.1 온라인 자료

- [OpenStreetMap Wiki](https://wiki.openstreetmap.org/) - 오픈소스 지도 프로젝트
- [Slippy Map Tilenames](https://wiki.openstreetmap.org/wiki/Slippy_map_tilenames) - 타일 좌표 계산법
- [Web Mercator 설명](https://en.wikipedia.org/wiki/Web_Mercator_projection)

### 8.2 실습 아이디어

1. **타일 URL 직접 열어보기**:
   ```
   브라우저에서 직접 입력:
   http://192.168.0.140:8082/tiles/SD/L7/100/50.png
   ```

2. **개발자 도구로 타일 관찰**:
   - 지도를 이동하면서 어떤 타일이 요청되는지 확인
   - 404 에러가 나는 타일이 있는지 확인

3. **줌 레벨 실험**:
   - 설정 파일에서 minZoom, maxZoom 변경해보기
   - 어떤 일이 생기는지 관찰

---

**다음: [OpenLayers 가이드로 이동 →](./OPENLAYERS_GUIDE.md)**
